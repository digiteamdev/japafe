name: Deploy Frontend

on:
  push:
    branches:
      - main  # Tetap gunakan `main` jika ini branch untuk frontend

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Setup SSH
      uses: webfactory/ssh-agent@v0.5.3
      with:
        ssh-private-key: ${{ secrets.SSH_PRIVATE_KEY }}

    - name: Deploy Frontend
      env:
        GITHUB_TOKEN: ${{ secrets.PAT_GITHUB }}
      run: |
        git config --global user.name "GitHub Actions"
        git config --global user.email "actions@github.com"
        ssh user@your_server_ip << EOF
          cd /var/www/japafe
          git pull https://${{ secrets.PAT_GITHUB }}@github.com/digiteamdev/japafe.git main
          npm install
          #npm run build  # Jika ada build untuk frontend
          pm2 restart all  # Restart Express.js server
        EOF
